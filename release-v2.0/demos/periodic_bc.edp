include "ffmatlib.idp"

mesh Th=square(30, 30, [2*x*pi,2*y*pi]);

fespace Vh(Th, P1, periodic=[[2,y],[4,y],[1,x],[3,x]]);
Vh u,v;

func f=sin(x+pi/4.)*cos(y+pi/2.);

problem laplace(u,v) = int2d(Th)(dx(u)*dx(v)+dy(u)*dy(v))
                      +int2d(Th)(-f*v);

laplace;

savemesh(Th, "periodic.msh");
ffSaveVh(Th,Vh,"periodic_vh.txt");
ffSaveData(u,"periodic.txt");

plot (u, value=true);
